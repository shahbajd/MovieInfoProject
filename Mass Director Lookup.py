#!/usr/bin/env pythonfrom collections import defaultdictfrom selenium import webdriverfrom selenium.webdriver.common.keys import Keysfrom BeautifulSoup import BeautifulSoupimport osimport requestsfrom openpyxl import load_workbookdef run_browser(query):	global movie_info		if query == "":		print "No Query" #replace with a dialogue box	else:		driver = webdriver.Chrome('/Users/Shahbaj/Komodo10/Selenium Drivers/chromedriver') # Open browser with reference to driver location		driver.get('http://www.imdb.com') #Enter URL		assert "IMDb" in driver.title #Confirmation of desired site		elem = driver.find_element_by_name("q") #Find search query textbox		elem.clear() #Clear contents of textbox		elem.send_keys(query) #enter search query		elem.send_keys(Keys.RETURN) #Keyboard "Enter" input		assert "No results found" not in driver.page_source #Confirmation "No results found" is NOT displayed		driver.find_element_by_xpath("//td[@class='result_text']/a[1]").click() #Find first result in list and click on it				#BEAUTIFUL SOUP		r = requests.get(driver.current_url)		web_info = BeautifulSoup(r.content)		year_block=web_info.find('span', id='titleYear')		year_line=year_block.find('a')		year=year_line.string		movie_info[key].append(int(year))		print year				director_info=web_info.find('span', itemprop='name')		director = director_info.string		movie_info[key].append(director)		print director				#driver.close()def Excel_Find():	title_col = 2	year_col = 3	rating_col = 4	director_col = 5	row_count = 3	global movie_info		os.chdir('/Users/Shahbaj/')	wb = load_workbook('Movie List.xlsx')	sheet_list = wb.get_sheet_names()	active_sheet=wb.get_sheet_by_name(sheet_list[0])		while(active_sheet.cell(row=row_count, column=title_col).value != None):		if (active_sheet.cell(row=row_count, column=director_col).value == None):			movie_info[active_sheet.cell(row=row_count, column=title_col).value].append(row_count)			movie_info[active_sheet.cell(row=row_count, column=title_col).value].append(active_sheet.cell(row=row_count, column=rating_col).value)		row_count+=1		if len(movie_info) >= 40:			break			wb.save('Movie List.xlsx')def Excel_Write(key):	title_col = 2	year_col = 3	rating_col = 4	director_col = 5		os.chdir('/Users/Shahbaj/')	wb = load_workbook('Movie List.xlsx')	sheet_list = wb.get_sheet_names()	active_sheet=wb.get_sheet_by_name(sheet_list[0])		active_sheet.cell(row=movie_info[key][0], column=rating_col).value = movie_info[key][1]	active_sheet.cell(row=movie_info[key][0], column=year_col).value = movie_info[key][2]	active_sheet.cell(row=movie_info[key][0], column=director_col).value = movie_info[key][3]		wb.save('Movie List.xlsx')	movie_info = defaultdict(list)Excel_Find()# print movie_infoprint movie_info.keys()for key in movie_info:	run_browser(key)	response = raw_input('Proceed? ')	if response == 'y':		Excel_Write(key)	elif response == 'n':		pass	elif response == 'q':		breakprint "Written to Excel"    